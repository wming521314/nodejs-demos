<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        .ball{
            width: 40px;
            height: 40px;
            border-radius: 20px;
        }
        .ball_1{
            background: red;
        }
        .ball_2{
            background: yellow;
        }
        .ball_3{
            background: green;
        }


    </style>
    <!--<script type='text/javascript' src="./bluebird.js"></script>-->
</head>
<body>
    <div class=" ball ball_1" style="margin-left: 0px;"></div>
    <div class=" ball ball_2" style="margin-left: 0px;"></div>
    <div class=" ball ball_3" style="margin-left: 0px;"></div>
</body>
<script>
    var Promise = window.Promise;
    var ball_1 = document.querySelector('.ball_1');
    var ball_2 = document.querySelector('.ball_2');
    var ball_3 = document.querySelector('.ball_3');

    function promiseAnimate(ball,distance){
        return new Promise(function(resolve,reject){
            function _animate(){
                setTimeout(function(){
                    var margin_left = parseInt(ball.style.marginLeft);

                    if(margin_left == distance){
                        resolve();
                    }else if(margin_left < distance){
                        margin_left++;
                    }else{
                        console.log(margin_left);
                        margin_left--;
                    }
                    ball.style.marginLeft = margin_left + 'px';
                    _animate();
                },13)
            }
            _animate();
        })

    }
    //animate(ball_1,10,function(){})
    console.log("aaa");
    promiseAnimate(ball_1,100)
        .then(function(){
            return promiseAnimate(ball_2,200);
        })
        .then(function(){
            return promiseAnimate(ball_3,300);
        })
        .then(function(){
            return promiseAnimate(ball_3,150);
        })
        .then(function(){
            return promiseAnimate(ball_2,150);
        })
        .then(function(){
            return promiseAnimate(ball_1,150);
        })
    //promiseAnimate(ball_2,200)
    console.log("bbb");
</script>
</html>